$.hood||($.hood={}),$.hood.Media={Init:function(){$("body").on("click",".delete-media",this.Delete),$("body").on("click",".delete-directory",this.DeleteDirectory),$("body").on("click",".create-directory",this.CreateDirectory),$("#media-list").doesExist()&&this.Manage.Init(),$("#media-upload").doesExist()&&this.Upload.Init()},Manage:{Init:function(){$("#media-list").hoodDataList({url:"/admin/media/get",params:function(){return{search:$("#media-search").val(),status:$("#media-status").val(),sort:$("#media-sort").val(),type:$("#media-type").val(),directory:$("#media-directory").val()}},pageSize:36,pagers:".media-pager",template:"#media-template",dataBound:function(){},refreshOnChange:".media-change",refreshOnClick:".media-click",serverAction:"GET"})},Refresh:function(){$.hood.Media.RefreshDirectories(),$("#media-list").doesExist()&&$("#media-list").data("hoodDataList").Refresh()}},Upload:{Init:function(){Dropzone.autoDiscover=!1;var e=new Dropzone("#media-upload",{url:$.hood.Media.Upload.UploadUrl,thumbnailWidth:80,thumbnailHeight:80,parallelUploads:5,previewTemplate:!1,paramName:"files",autoProcessQueue:!0,previewsContainer:!1,clickable:"#media-add",dictDefaultMessage:'<span><i class="fa fa-cloud-upload fa-4x"></i><br />Drag and drop files here, or simply click me!</div>',dictResponseError:"Error while uploading file!"});e.on("success",function(e,t){t.Success===!1?$.hood.Alerts.Error("Uploads failed: "+t.Message):$.hood.Alerts.Success("Uploads completed successfully.")}),e.on("addedfile",function(e){}),e.on("totaluploadprogress",function(e){document.querySelector("#media-total-progress .progress-bar").style.width=e+"%"}),e.on("sending",function(e){document.querySelector("#media-total-progress").style.opacity="1"}),e.on("complete",function(e){$.hood.Media.Manage.Refresh()}),e.on("queuecomplete",function(e){document.querySelector("#media-total-progress").style.opacity="0",$.hood.Media.Manage.Refresh()})},UploadUrl:function(){return"/admin/media/upload/simple?directory="+$("#media-directory").val()}},RefreshDirectories:function(){$.hood.Inline.Reload(".directories",function(){$(".media-click").parent("li").removeClass("active"),$('.media-click[data-value="'+$("#media-directory").val()+'"]').parent("li").addClass("active")})},RestrictDir:function(){var e=/[^0-9A-Za-z- ]*/g,t=$(this).val(),o=t.replace(e,"");t!==o&&$(this).val(o)},CreateDirectory:function(){$("body").on("keyup",".sweet-alert input",$.hood.Media.RestrictDir),swal({title:"Create directory",text:"Please enter a name for your new directory:",type:"input",showCancelButton:!0,closeOnCancel:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,animation:"slide-from-top",inputPlaceholder:"Directory name..."},function(e){return e!==!1&&(""===e?(swal.showInputError("You didn't supply a directory name, we can't create one without it!"),!1):($.get("/admin/media/addDirectory/",{directory:e},function(e){e.Success?($.hood.Media.Manage.Refresh(),swal("Woohoo!","Directory has been successfully added...","success")):swal("Oops!","There was a problem creating the new directory:\n\n"+e.Errors,"error")}),$("body").off("keyup",".sweet-alert input",$.hood.Media.RestrictDir),!0))})},Delete:function(e){var t=$(this);swal({title:"Are you sure?",text:"The media file will be permanently removed.\n\nWarning: Ensure this file is not attached to any posts, pages or features of the site, or it will appear as a broken image or file.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, cancel!",closeOnConfirm:!1,showLoaderOnConfirm:!0,closeOnCancel:!1},function(e){e?$.post("/admin/media/delete",{id:t.data("id")},function(e){e.Success?($.hood.Media.Manage.Refresh(),$.hood.Blades.Close(),swal({title:"Deleted!",text:"The media file has now been removed from the website.",timer:1300,type:"success"})):swal({title:"Error!",text:"There was a problem deleting the media file: "+e.Errors,timer:1300,type:"error"})}):swal("Cancelled","It's all good in the hood!","error")})},DeleteDirectory:function(e){$(this);message="The directory and all files will be permanently removed.\n\nWarning: Ensure these files are not attached to any posts, pages or features of the site, or it will appear as a broken image or file.",""===$("#media-directory").val()&&(message="You have selected to delete All directories, this will remove ALL files and ALL directories from the site. Are you sure!?"),swal({title:"Are you sure?",text:message,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, cancel!",closeOnConfirm:!1,showLoaderOnConfirm:!0,closeOnCancel:!1},function(e){e?$.post("/admin/media/directory/delete",{directory:$("#media-directory").val()},function(e){e.Success?($.hood.Media.Manage.Refresh(),$.hood.Blades.Close(),swal({title:"Deleted!",text:"The directory has now been removed from the website.",timer:1300,type:"success"})):swal({title:"Error!",text:"There was a problem directory the . "+e.Errors,timer:1300,type:"error"})}):swal("Cancelled","It's all good in the hood!","error")})},Players:{},LoadMediaPlayer:function(e,t,o){var a={techOrder:["azureHtml5JS","flashSS","html5FairPlayHLS","silverlightSS","html5"],nativeControlsForTouch:!1,controls:!0,autoplay:!1,seeking:!0};$(e).each(function(){player=$.hood.Media.Players[$(this).data("id")],player&&player.dispose(),$.hood.Media.Players[$(this).data("id")]=amp($(this).attr("id"),a),player=$.hood.Media.Players[$(this).data("id")],player.src([{src:t,type:o}])})}},$.hood.Media.Init();
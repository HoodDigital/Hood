"use strict";$.hood||($.hood={}),$.hood.Content={Init:function(){$("body").on("click",".content-delete",$.hood.Content.Delete),$("body").on("click",".content-meta-delete",$.hood.Content.Meta.Delete),$("body").on("click",".content-clone",$.hood.Content.Clone),$("body").on("click",".content-set-status",$.hood.Content.SetStatus),$("body").on("click",".content-media-delete",$.hood.Content.Media.Delete),$("body").on("click",".content-categories-delete",$.hood.Content.Categories.Delete),$("body").on("change",".content-categories-check",$.hood.Content.Categories.ToggleCategory),$("body").on("click",".add-custom-field",$.hood.Content.Types.AddField),$("body").on("click",".delete-custom-field",$.hood.Content.Types.DeleteField),$("body").on("keyup","#Slug",function(){$(".slug-display").html($(this).val())}),$("#content-edit-form").doesExist()&&$.hood.Content.Edit.Init(),$("#content-meta-form").doesExist()&&$.hood.Content.Meta.Init()},Lists:{Content:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#content-list").doesExist()&&$.hood.Inline.Reload($("#content-list"),e)}},Categories:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#content-categories-list").doesExist()&&$.hood.Inline.Reload($("#content-categories-list"),e)}},Fields:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#content-meta-list").doesExist()&&$.hood.Inline.Reload($("#content-meta-list"),e)}},Media:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#content-media-list").doesExist()&&$.hood.Inline.Reload($("#content-media-list"),e)}}},Delete:function(e){e.preventDefault();var t=$(this),o=function(e){e&&$.post(t.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Content.Reload(),e.Success&&t&&t.data("redirect")&&($.hood.Alerts.Success("<strong>Content deleted, redirecting...</strong><br />Just taking you back to the content list."),setTimeout(function(){window.location=t.data("redirect")},1500))})};$.hood.Alerts.Confirm("The content will be permanently removed.","Are you sure?",o,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong></span>')},SetStatus:function(e){e.preventDefault();var t=$(this),o=function(e){e&&$.post(t.attr("href"),t.data("status"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Content.Reload()})};$.hood.Alerts.Confirm("The item will be immediately visible on the website.","Are you sure?",o,"warning")},Clone:function(e){e.preventDefault();var t=$(this),o=function(e){e&&$.post(t.attr("href"),t.data("status"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Content.Reload()})};$.hood.Alerts.Confirm("This will duplicate the content and everything inside it.","Are you sure?",o,"warning")},Create:function(){$("#content-create-form").find(".datepicker").datetimepicker({locale:"en-gb",format:"L"}),$("#content-create-form").hoodValidator({validationRules:{Title:{required:!0},Except:{required:!0},PublishDate:{required:!0,ukdate:!0}},submitButtonTag:$("#content-create-submit"),submitUrl:$("#content-create-form").attr("action"),submitFunction:function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Content.Reload()}})},Edit:{Init:function(){$(".datepicker").datetimepicker({locale:"en-gb",format:"L"}),$(".timepicker").datetimepicker({locale:"en-gb",format:"LT"}),$(".datetimepicker").datetimepicker({locale:"en-gb",sideBySide:!0}),$.hood.Content.Edit.InitImageUploader()},InitImageUploader:function(){if($("#content-gallery-add").doesExist()){$("#content-gallery-total-progress").hide(),Dropzone.autoDiscover=!1;var e=new Dropzone("#content-gallery-upload",{url:$("#content-gallery-upload").data("url"),thumbnailWidth:80,thumbnailHeight:80,parallelUploads:5,previewTemplate:!1,paramName:"files",autoProcessQueue:!0,previewsContainer:!1,clickable:"#content-gallery-add",dictDefaultMessage:'<span><i class="fa fa-cloud-upload fa-4x"></i><br />Drag and drop files here, or simply click me!</div>',dictResponseError:"Error while uploading file!"});e.on("success",function(e,t){$.hood.Helpers.ProcessResponse(t),$.hood.Content.Lists.Media.Reload()}),e.on("addedfile",function(e){$("#content-gallery-total-progress .progress-bar").css({width:"0%"}),$("#content-gallery-total-progress .progress-bar .percentage").html("0%")}),e.on("totaluploadprogress",function(e){$("#content-gallery-total-progress .progress-bar").css({width:e+"%"}),$("#content-gallery-total-progress .progress-bar .percentage").html(e+"%")}),e.on("sending",function(e){$("#content-gallery-total-progress").fadeIn(),$("#content-gallery-total-progress .progress-bar").css({width:"0%"}),$("#content-gallery-total-progress .progress-bar .percentage").html("0%")}),e.on("complete",function(e){$.hood.Content.Lists.Media.Reload()}),e.on("queuecomplete",function(e){$("#content-gallery-total-progress").hide(),$.hood.Content.Lists.Media.Reload()})}}},Categories:{Editor:function(){$("#content-categories-edit-form").hoodValidator({validationRules:{DisplayName:{required:!0},Slug:{required:!0}},submitButtonTag:$("#content-categories-edit-submit"),submitUrl:$("#content-categories-edit-form").attr("action"),submitFunction:function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Categories.Reload()}})},ToggleCategory:function(){$.post($(this).data("url"),{categoryId:$(this).val(),add:$(this).is(":checked")},function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Categories.Reload()})},Delete:function(e){e.preventDefault();var t=$(this),o=function(e){e&&$.post(t.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Categories.Reload()})};$.hood.Alerts.Confirm("The category will be permanently removed.","Are you sure?",o,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong></span>')}},Meta:{Create:function(){$("#add-field-form").hoodValidator({validationRules:{cfName:{required:!0},cfType:{required:!0}},submitButtonTag:$("#add-field-submit"),submitUrl:"/admin/content/addmeta",submitFunction:function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Fields.Reload()}})},Delete:function(e){e.preventDefault();var t=$(this),o=function(e){e&&$.post(t.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Fields.Reload()})};$.hood.Alerts.Confirm("The field will be permanently removed.","Are you sure?",o,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong></span>')}},Media:{Delete:function(e){e.preventDefault();var t=$(this),o=function(e){e&&$.post(t.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Content.Lists.Media.Reload()})};$.hood.Alerts.Confirm("The image/media will be permanently removed.","Are you sure?",o,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong><br /><span class="text-warning">If this is set as a featured image, this may cause issues, make sure to set another image as featured before deleting this one.</span></span>')}},Types:{AddField:function(){var e=$("#custom-field-name-"+$(this).data("id")).val(),t=$.hood.Content.Types.GetFieldsList($(this).data("id")),o=!1;if($.each(t,function(t,n){n.Name===e&&(o=!0)}),!e)return void $.hood.Alerts.Error("You have to name the field.");if(!t)return void $.hood.Alerts.Error("The field list is empty.");if(o)return void $.hood.Alerts.Error("Cannot insert two fields with the same key.");var n={Name:$("#custom-field-name-"+$(this).data("id")).data("prefix")+$("#custom-field-name-"+$(this).data("id")).val(),Default:$("#custom-field-default-"+$(this).data("id")).val(),Type:$("#custom-field-type-"+$(this).data("id")).val(),System:!1};t.push(n),$.hood.Content.Types.ReRenderFields(t,$(this).data("id")),$("#custom-fields-"+$(this).data("id")).val(JSON.stringify(t)),$.hood.Alerts.Success("Added field.")},DeleteField:function(){var e=$.hood.Content.Types.GetFieldsList($(this).data("id")),t=$(this).data("name");e=$.grep(e,function(e){return e.Name!==t}),$.hood.Content.Types.ReRenderFields(e,$(this).data("id")),$("#custom-fields-"+$(this).data("id")).val(JSON.stringify(e)),$.hood.Alerts.Success("Deleted field.")},GetFieldsList:function(e){var t=$("#custom-fields-"+e).val();if(null!==t&&""!==t){var o=JSON.parse(t);for(var n in o)if(o[n].hasOwnProperty("Name"))return o}return new Array},ReRenderFields:function(e,t){var o=$("#field-list-"+t).empty();for(i=0;i<e.length;i++){var n="<tr><td class='col-xs-8'><strong>"+e[i].Name+"</strong> "+e[i].Type+"</td><td class='col-xs-4 text-right'>";n+=e[i].System?'<span class="label label-default">System Field</span>':"<a class='delete-custom-field btn btn-xs bg-color-red txt-color-white' data-name='"+e[i].Name+"' data-id='"+t+"'><i class='fa fa-trash-o'></i></a>",n+="</td></tr>",o.append(n)}}}},$(document).ready($.hood.Content.Init);
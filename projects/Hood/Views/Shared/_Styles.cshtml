@inject IThemesService _themes
<environment names="Development,Staging,ErrorTesting">
    <link rel="stylesheet" href="~/css/preload.css" />
    <noscript id="deferred-styles">
        <link rel="stylesheet" href="~/lib/font-awesome/css/font-awesome.css" />
        @if (_themes.CurrentTheme == "default")
        {
            <link rel="stylesheet" href="~/css/site.css" />
        }
        else
        {
            <link rel="stylesheet" href="@string.Format("~/themes/{0}/css/site.min.css", _themes.CurrentTheme)" />
        }
    </noscript>
</environment>
<environment names="Production,PreProduction">
    <link rel="stylesheet" href="~/css/preload.css" />
    <noscript id="deferred-styles">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
        @if (_themes.CurrentTheme == "default")
        {
            <link rel="stylesheet" href="https://hood.azureedge.net/cdn/1.0.1/dist/css/app.min.css" />
        }
        else
        {
            <link rel="stylesheet" href="@string.Format("~/themes/{0}/css/site.min.css", _themes.CurrentTheme)" />
        }
    </noscript>
</environment>
<script>
    var loadDeferredStyles = function () {
        var addStylesNode = document.getElementById("deferred-styles");
        var replacement = document.createElement("div");
        replacement.innerHTML = addStylesNode.textContent;
        document.body.appendChild(replacement)
        addStylesNode.parentElement.removeChild(addStylesNode);
    };
    var raf = requestAnimationFrame || mozRequestAnimationFrame ||
        webkitRequestAnimationFrame || msRequestAnimationFrame;
    if (raf) raf(function () { window.setTimeout(loadDeferredStyles, 0); });
    else window.addEventListener('load', loadDeferredStyles);
</script>

"use strict";$.hood||($.hood={}),$.hood.Inline={Tags:{},Init:function(){$(".hood-inline:not(.refresh)").each($.hood.Inline.Load),$("body").on("click",".hood-inline-task",$.hood.Inline.Task),$("body").on("click",".hood-modal",function(o){o.preventDefault(),$.hood.Inline.Modal($(this).attr("href"),$(this).data("complete"))}),$.hood.Inline.DataList.Init()},Refresh:function(o){$(o||".hood-inline").each($.hood.Inline.Load)},Load:function(){$.hood.Inline.Reload(this)},Reload:function(o,n){var e=$(o);e.addClass("loading"),n||(n=e.data("complete"));var t=e.data("url");$.get(t,$.proxy(function(o){$(this).html(o),$(this).removeClass("loading")},e)).done(function(){$.hood.Inline.RunComplete(n)}).fail($.hood.Inline.HandleError).always($.hood.Inline.Finish)},CurrentModal:null,Modal:function(o,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&$.hood.Inline.CurrentModal&&$.hood.Inline.CurrentModal.modal("hide"),$.get(o,function(o){modalId="#"+$(o).attr("id"),$(o).addClass("hood-inline-modal"),$(modalId).length&&$(modalId).remove(),$("body").append(o),$.hood.Inline.CurrentModal=$(modalId),$(modalId).modal(),$(modalId).on("shown.bs.modal",function(){$(document).off("focusin.modal")})}).done(function(){$.hood.Inline.RunComplete(n)}).fail($.hood.Inline.HandleError).always($.hood.Inline.Finish)},CloseModal:function(){$.hood.Inline.CurrentModal&&$.hood.Inline.CurrentModal.modal("hide")},Task:function(o){o.preventDefault(),$tag=$(o.currentTarget),$tag.addClass("loading"),complete=$tag.data("complete"),$.get($tag.attr("href"),function(o){$.hood.Helpers.ProcessResponse(o),o.Success&&$tag&&$tag.data("redirect")&&setTimeout(function(){window.location=$tag.data("redirect")},1500),$tag.removeClass("loading")}).done(function(){$.hood.Inline.RunComplete(complete)}).fail($.hood.Inline.HandleError).always($.hood.Inline.Finish)},DataList:{Init:function(){$(".hood-inline-list.query").each(function(){$(this).data("url",$(this).data("url")+window.location.search)}),$(".hood-inline-list:not(.refresh)").each($.hood.Inline.Load),$("body").on("click",".hood-inline-list .pagination a",function(o){o.preventDefault(),$.hood.Loader(!0);var n=document.createElement("a");n.href=$(this).attr("href"),$list=$(this).parents(".hood-inline-list"),$.hood.Inline.DataList.Reload($list,n)}),$("body").on("submit",".hood-inline-list form",function(o){o.preventDefault(),$.hood.Loader(!0),$form=$(this),$list=$form.parents(".hood-inline-list");var n=document.createElement("a");n.href=$list.data("url"),n.search="?"+$form.serialize(),$.hood.Inline.DataList.Reload($list,n)}),$("body").on("submit","form.inline",function(o){o.preventDefault(),$.hood.Loader(!0),$form=$(this),$list=$($form.data("target"));var n=document.createElement("a");n.href=$list.data("url"),n.search="?"+$form.serialize(),$.hood.Inline.DataList.Reload($list,n)}),$("body").on("change","form.inline .refresh-on-change, .hood-inline-list form",function(o){o.preventDefault(),$.hood.Loader(!0),$form=$(this).parents("form"),$list=$($form.data("target"));var n=document.createElement("a");n.href=$list.data("url"),n.search="?"+$form.serialize(),$.hood.Inline.DataList.Reload($list,n)})},Reload:function(o,n){if(history.pushState&&o.hasClass("query")){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+n.href.substring(n.href.indexOf("?")+1);window.history.pushState({path:e},"",e)}o.data("url",$.hood.Helpers.InsertQueryStringParamToUrl(n,"inline","true")),$.hood.Inline.Reload(o)}},HandleError:function(o){500===o.status?$.hood.Alerts.Error("<strong>Error "+o.status+"</strong><br />There was an error processing the content, please contact an administrator if this continues.<br/>"):404===o.status?$.hood.Alerts.Error("<strong>Error "+o.status+"</strong><br />The content could not be found.<br/>"):401===o.status&&($.hood.Alerts.Error("<strong>Error "+o.status+"</strong><br />You are not allowed to view this resource, are you logged in correctly?<br/>"),window.location=window.location)},Finish:function(o){$.hood.Loader(!1)},RunComplete:function RunComplete(complete){if(!$.hood.Helpers.IsNullOrUndefined(complete)){var func=eval(complete);"function"==typeof func&&func()}}},$(document).ready($.hood.Inline.Init),$.hood.Modals={Open:$.hood.Inline.Modal};
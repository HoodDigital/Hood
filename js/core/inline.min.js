"use strict";$.hood||($.hood={}),$.hood.Inline={Tags:{},Init:function(){$(".hood-inline:not(.refresh)").each($.hood.Inline.Load),$("body").on("click",".hood-inline-task",$.hood.Inline.Task),$("body").on("click",".hood-modal",function(o){o.preventDefault(),$.hood.Inline.Modal($(this).attr("href"),$(this).data("complete"))}),$.hood.Inline.DataList.Init()},Refresh:function(o){$(o||".hood-inline").each($.hood.Inline.Load)},Load:function(){$.hood.Inline.Reload(this)},Reload:function(o,e){var n=$(o);n.addClass("loading"),e||(e=n.data("complete"));var t=n.data("url");$.get(t,$.proxy(function(o){n.html(o),n.removeClass("loading"),e&&$.hood.Inline.RunComplete(e,n,o)},n)).fail($.hood.Inline.HandleError).always($.hood.Inline.Finish)},CurrentModal:null,Modal:function(o,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&$.hood.Inline.CurrentModal&&$.hood.Inline.CurrentModal.modal("hide"),$.get(o,function(o){var n="#"+$(o).attr("id");$(o).addClass("hood-inline-modal"),$(n).length&&$(n).remove(),$("body").append(o),$.hood.Inline.CurrentModal=$(n),$(n).modal(),$(n).on("shown.bs.modal",function(){$(document).off("focusin.modal")}),$(n).on("hidden.bs.modal",function(o){$(this).remove()}),e&&$.hood.Inline.RunComplete(e,$(n),o)}).fail($.hood.Inline.HandleError).always($.hood.Inline.Finish)},CloseModal:function(){$.hood.Inline.CurrentModal&&$.hood.Inline.CurrentModal.modal("hide")},Task:function(o){o.preventDefault();var e=$(o.currentTarget);e.addClass("loading"),complete=e.data("complete"),$.get(e.attr("href"),function(o){$.hood.Helpers.ProcessResponse(o),o.Success&&e&&e.data("redirect")&&setTimeout(function(){window.location=e.data("redirect")},1500),e.removeClass("loading"),complete&&$.hood.Inline.RunComplete(complete,e,o)}).fail($.hood.Inline.HandleError).always($.hood.Inline.Finish)},DataList:{Init:function(){$(".hood-inline-list.query").each(function(){$(this).data("url",$(this).data("url")+window.location.search)}),$(".hood-inline-list:not(.refresh)").each($.hood.Inline.Load),$("body").on("click","a.hood-inline-list-target",function(o){o.preventDefault(),$.hood.Loader(!0);var e=document.createElement("a");e.href=$(this).attr("href");var n=$($(this).data("target")),t=document.createElement("a");t.href=n.data("url"),t.search=e.search,$.hood.Inline.DataList.Reload(n,t),complete=$(this).data("complete"),complete&&$.hood.Inline.RunComplete(complete,$(this))}),$("body").on("click",".hood-inline-list .pagination a",function(o){o.preventDefault(),$.hood.Loader(!0);var e=document.createElement("a");e.href=$(this).attr("href");var n=$(this).parents(".hood-inline-list"),t=document.createElement("a");t.href=n.data("url"),t.search=e.search,$.hood.Inline.DataList.Reload(n,t)}),$("body").on("submit",".hood-inline-list form",function(o){o.preventDefault(),$.hood.Loader(!0);var e=$(this),n=e.parents(".hood-inline-list"),t=document.createElement("a");t.href=n.data("url"),t.search="?"+e.serialize(),$.hood.Inline.DataList.Reload(n,t)}),$("body").on("submit","form.inline",function(o){o.preventDefault(),$.hood.Loader(!0);var e=$(this),n=$(e.data("target")),t=document.createElement("a");t.href=n.data("url"),t.search="?"+e.serialize(),$.hood.Inline.DataList.Reload(n,t)}),$("body").on("change","form.inline .refresh-on-change, .hood-inline-list form",function(o){o.preventDefault(),$.hood.Loader(!0);var e=$(this).parents("form"),n=$(e.data("target")),t=document.createElement("a");t.href=n.data("url"),t.search="?"+e.serialize(),$.hood.Inline.DataList.Reload(n,t)})},Reload:function(o,e){if(history.pushState&&o.hasClass("query")){var n=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+e.href.substring(e.href.indexOf("?")+1);window.history.pushState({path:n},"",n)}o.data("url",$.hood.Helpers.InsertQueryStringParamToUrl(e,"inline","true")),$.hood.Inline.Reload(o)}},HandleError:function(o){500===o.status?$.hood.Alerts.Error("<strong>Error "+o.status+"</strong><br />There was an error processing the content, please contact an administrator if this continues.<br/>"):404===o.status?$.hood.Alerts.Error("<strong>Error "+o.status+"</strong><br />The content could not be found.<br/>"):401===o.status&&($.hood.Alerts.Error("<strong>Error "+o.status+"</strong><br />You are not allowed to view this resource, are you logged in correctly?<br/>"),window.location=window.location)},Finish:function(){$.hood.Loader(!1)},RunComplete:function RunComplete(complete,sender,data){if(!$.hood.Helpers.IsNullOrUndefined(complete)){var func=eval(complete);"function"==typeof func&&func(sender,data)}}},$(document).ready($.hood.Inline.Init),$.hood.Modals={Open:$.hood.Inline.Modal};
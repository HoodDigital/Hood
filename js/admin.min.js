"use strict";$.hood||($.hood={}),$.hood.Admin={Init:function(){$(".navbar-nav .collapse").on("show.bs.collapse",function(){!function(e){var a=e.closest(".navbar-nav, .navbar-nav .nav").querySelectorAll(".collapse");[].forEach.call(a,function(a){a!==e&&$(a).collapse("hide")})}(this)}),$(".mobile-sidebar-toggle").on("click",function(){$("nav.sidebar").toggleClass("open")}),$(".right-sidebar-toggle").on("click",function(){$("#right-sidebar").toggleClass("sidebar-open")}),$(".alert.auto-dismiss").fadeTo(5e3,500).slideUp(500,function(){$(".alert.auto-dismiss").slideUp(500)}),$(".sidebar-scroll").slimScroll({height:"100%",railOpacity:.4,wheelStep:10}),$('[data-plugin="counter"]')&&$.counterUp&&$('[data-plugin="counter"]').counterUp({delay:10,time:800}),$.hood.Admin.Editors.Init(),$.hood.Admin.Stats.Init()},Editors:{Init:function(){tinymce.init({selector:".tinymce-full",height:150,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],toolbar:"styleselect | bold italic | alignleft aligncenter alignright | bullist numlist | link image media hoodimage | code",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,setup:$.hood.Media.Actions.Load.Insert,image_dimensions:!1}),tinymce.init({selector:".tinymce-simple",height:150,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],menubar:!1,toolbar:"bold italic | bullist numlist | undo redo | link",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,image_dimensions:!1}),tinymce.init({selector:".tinymce-full-content",height:500,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],toolbar:"styleselect | bold italic | alignleft aligncenter alignright | bullist numlist | link image media hoodimage | code",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,setup:$.hood.Media.Actions.Load.Insert,image_dimensions:!1}),tinymce.init({selector:".tinymce-simple-content",height:500,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],menubar:!1,toolbar:"bold italic | bullist numlist | undo redo | link",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,image_dimensions:!1})}},Load:function(){$.hood.Admin.Resize()},Ready:function(){$.hood.Admin.CheckAndLoadTabs("#page-tabs"),$.hood.Admin.Resize()},Resize:function(){$(window).width()>768&&$(".content-body").css({"min-height":$(window).height()-216})},Stats:{Init:function(){$("#admin-chart-area").exists()&&($.hood.Admin.Stats.LoadChart(),$("body").on("change","#history",function(){$.hood.Admin.Stats.LoadChart()}))},LoadChart:function(){$.get("/admin/stats/",function(e){$("#admin-chart-area").empty(),$("#admin-chart-area").html('<canvas id="admin-stats-chart"></canvas>'),$.hood.Admin.Stats.LoadStats(e),$.hood.Admin.Stats.DoCharts(e)})},SetupCharts:function(){Chart.defaults.global.responsive=!0,Chart.defaults.global.maintainAspectRatio=!1,Chart.defaults.global.defaultColor="#6E84A3",Chart.defaults.global.defaultFontColor="#6E84A3",Chart.defaults.global.defaultFontFamily="",Chart.defaults.global.defaultFontSize=16,Chart.defaults.global.layout.padding=0,Chart.defaults.global.legend.display=!0,Chart.defaults.global.legend.position="bottom",Chart.defaults.global.legend.labels.usePointStyle=!0,Chart.defaults.global.legend.labels.padding=25,Chart.defaults.global.elements.point.radius=5,Chart.defaults.global.elements.point.backgroundColor="#000000",Chart.defaults.global.elements.line.tension=.4,Chart.defaults.global.elements.line.borderWidth=3,Chart.defaults.global.elements.line.borderColor="#aaaaaa",Chart.defaults.global.elements.line.backgroundColor="transparent",Chart.defaults.global.elements.line.borderCapStyle="round",Chart.defaults.global.elements.rectangle.backgroundColor="#aaaaaa",Chart.defaults.global.elements.arc.backgroundColor="#2C7BE5",Chart.defaults.global.elements.arc.borderColor="#152E4D",Chart.defaults.global.elements.arc.borderWidth=4,Chart.defaults.global.elements.arc.hoverBorderColor="#152E4D",Chart.defaults.global.tooltips.enabled=!0,Chart.defaults.global.tooltips.mode="nearest",Chart.defaults.global.tooltips.intersect=!1,Chart.scaleService.updateScaleDefaults("linear",{gridLines:{borderDash:[2],borderDashOffset:[2],color:"#dedede",drawBorder:!1,drawTicks:!1,zeroLineColor:"#dedede",zeroLineBorderDash:[2],zeroLineBorderDashOffset:[2]},ticks:{beginAtZero:!0,padding:2,callback:function(e){return e}}}),Chart.scaleService.updateScaleDefaults("category",{gridLines:{drawBorder:!1,drawOnChartArea:!1,drawTicks:!1},ticks:{padding:5}})},DoCharts:function(e){var a=[],t=[],o="#fabd07",l="#20c997",s="#fd7e14",i="#17a2b8",n=[],r=[];e.content.months.forEach(function(e){r.push(e.Value),n.push(e.Key)}),a.push({label:"New Content",data:r,borderColor:o,backgroundColor:o,pointBackgroundColor:o,pointBorderColor:"#ffffff"}),r=[],e.users.months.forEach(function(e){r.push(e.Value)}),a.push({label:"New Users",data:r,borderColor:s,backgroundColor:s,pointBackgroundColor:s,pointBorderColor:"#ffffff"}),r=[],e.subs.months.forEach(function(e){r.push(e.Value)}),a.push({label:"New Subscriptions",data:r,borderColor:i,backgroundColor:i,pointBackgroundColor:i,pointBorderColor:"#ffffff"}),r=[],e.properties.months.forEach(function(e){r.push(e.Value)}),a.push({label:"New Properties",data:r,borderColor:l,backgroundColor:l,pointBackgroundColor:l,pointBorderColor:"#ffffff"}),t=n;var d=document.getElementById("admin-stats-chart");new Chart(d,{type:"bar",data:{labels:t,datasets:a},responsive:!0,maintainAspectRatio:!1,options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})},LoadStats:function(e){$(".content-totalPosts").text(e.content.totalPosts),$(".content-totalPublished").text(e.content.totalPublished),$(".users-totalUsers").text(e.users.totalUsers),$(".users-totalAdmins").text(e.users.totalAdmins),$(".subs-active").text(e.subs.active),$(".subs-trials").text(e.subs.trials),$(".properties-totalPosts").text(e.properties.totalPosts),$(".properties-totalPublished").text(e.properties.totalPublished);for(var a=0;a<e.content.byType.length;a++)$(".content-"+e.content.byType[a].typeName+"-total").text(e.content.byType[a].total)}},CheckAndLoadTabs:function(e){$(e).each(function(){var e=$('<li class="nav-item d-inline d-lg-none"></li>'),a=$('<div class="dropdown-menu"></ul>'),t=$('<ul class="navbar-nav"></ul>');$(this).find("> li").each(function(){var e=$(this).children("a:first-child"),a=$('<li class="nav-item"><a href="'+e.attr("href")+'" data-toggle="tab" class="nav-link tab-switch">'+e.html()+"</a></li>");t.append(a),$(this).addClass("d-none d-lg-inline")}),e.append('<a class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-eye mr-2"></i><span>Choose View</span></button>'),a.append(t),e.append(a),$(this).prepend(e)}),$(e+' a[data-toggle="tab"]').on("shown.bs.tab",function(a){localStorage.setItem("tab-"+$(e).data("id"),$(a.target).attr("href"))});var a=localStorage.getItem("tab-"+$(e).data("id"));a?$(e+' a[href="'+a+'"]').tab("show"):$(e+' a[data-toggle="tab"]').first().tab("show")}},$(document).ready($.hood.Admin.Ready),$(window).on("load",$.hood.Admin.Load),$(window).on("resize",$.hood.Admin.Resize),$.hood.Admin.Init();
"use strict";$.hood||($.hood={}),$.hood.Admin={Init:function(){$(".navbar-nav .collapse").on("show.bs.collapse",function(){!function(t){var e=t.closest(".navbar-nav, .navbar-nav .nav").querySelectorAll(".collapse");[].forEach.call(e,function(e){e!==t&&$(e).collapse("hide")})}(this)}),$(".mobile-sidebar-toggle").on("click",function(){$("nav.sidebar").toggleClass("open")}),$(".right-sidebar-toggle").on("click",function(){$("#right-sidebar").toggleClass("sidebar-open")}),$(".alert.auto-dismiss").fadeTo(5e3,500).slideUp(500,function(){$(".alert.auto-dismiss").slideUp(500)}),$(".sidebar-scroll").slimScroll({height:"100%",railOpacity:.4,wheelStep:10}),$('[data-plugin="counter"]').counterUp({delay:10,time:3e3}),$.hood.Admin.Editors.Init(),$.hood.Admin.Stats.Init(),$(".colorpicker-component").colorpicker()},Editors:{Init:function(){tinymce.init({selector:".tinymce-full",height:150,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],toolbar:"styleselect | bold italic | alignleft aligncenter alignright | bullist numlist | link image media hoodimage | code",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,setup:$.hood.Media.Actions.Load.Insert,image_dimensions:!1,content_css:["/css/site.min.css"]}),tinymce.init({selector:".tinymce-simple",height:150,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],menubar:!1,toolbar:"bold italic | bullist numlist | undo redo | link",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,image_dimensions:!1,content_css:["/css/site.min.css"]}),tinymce.init({selector:".tinymce-full-content",height:500,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],toolbar:"styleselect | bold italic | alignleft aligncenter alignright | bullist numlist | link image media hoodimage | code",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,setup:$.hood.Media.Actions.Load.Insert,image_dimensions:!1,content_css:["/css/site.min.css"]}),tinymce.init({selector:".tinymce-simple-content",height:500,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste code"],menubar:!1,toolbar:"bold italic | bullist numlist | undo redo | link",link_class_list:$.hood.LinkClasses,image_class_list:$.hood.ImageClasses,image_dimensions:!1,content_css:["/css/site.min.css"]})}},Load:function(){$.hood.Admin.Resize()},Ready:function(){$.hood.Admin.CheckAndLoadTabs("#page-tabs"),$.hood.Admin.Resize()},Resize:function(){$(window).width()>768&&$(".content-body").css({"min-height":$(window).height()-216})},Stats:{Init:function(){$.hood.Admin.Stats.SetupCharts(),$("#admin-stats-chart").exists()&&($.get("/admin/stats/",function(t){$.hood.Admin.Stats.LoadStats(t),$.hood.Admin.Stats.DoCharts(t)}),$("body").on("change","#history",function(){$.get("/admin/stats/",function(t){$.hood.Admin.Stats.DoCharts(t)})}))},SetupCharts:function(){Chart.defaults.global.responsive=!0,Chart.defaults.global.maintainAspectRatio=!1,Chart.defaults.global.defaultColor="#6E84A3",Chart.defaults.global.defaultFontColor="#6E84A3",Chart.defaults.global.defaultFontFamily="",Chart.defaults.global.defaultFontSize=12,Chart.defaults.global.layout.padding=0,Chart.defaults.global.legend.display=!0,Chart.defaults.global.legend.position="bottom",Chart.defaults.global.legend.labels.usePointStyle=!0,Chart.defaults.global.legend.labels.padding=25,Chart.defaults.global.elements.point.radius=5,Chart.defaults.global.elements.point.backgroundColor="#000000",Chart.defaults.global.elements.line.tension=.4,Chart.defaults.global.elements.line.borderWidth=3,Chart.defaults.global.elements.line.borderColor="#aaaaaa",Chart.defaults.global.elements.line.backgroundColor="transparent",Chart.defaults.global.elements.line.borderCapStyle="round",Chart.defaults.global.elements.rectangle.backgroundColor="#aaaaaa",Chart.defaults.global.elements.arc.backgroundColor="#2C7BE5",Chart.defaults.global.elements.arc.borderColor="#152E4D",Chart.defaults.global.elements.arc.borderWidth=4,Chart.defaults.global.elements.arc.hoverBorderColor="#152E4D",Chart.defaults.global.tooltips.enabled=!0,Chart.defaults.global.tooltips.mode="nearest",Chart.defaults.global.tooltips.intersect=!1,Chart.scaleService.updateScaleDefaults("linear",{gridLines:{borderDash:[2],borderDashOffset:[2],color:"#dedede",drawBorder:!1,drawTicks:!1,zeroLineColor:"#dedede",zeroLineBorderDash:[2],zeroLineBorderDashOffset:[2]},ticks:{beginAtZero:!0,padding:10,callback:function(t){return t}}}),Chart.scaleService.updateScaleDefaults("category",{gridLines:{drawBorder:!1,drawOnChartArea:!1,drawTicks:!1},ticks:{padding:20},maxBarThickness:10})},DoCharts:function(t){if(datasets=[],dataLabels=[],contentColour="#6f42c1",propertyColour="#20c997",userColour="#fd7e14",subColour="#17a2b8",Number($("#history").val())<100){labels=[];var e=t.content.days.slice(Math.max(t.content.days.length-Number($("#history").val()),1));contentSet=[],e.forEach(function(t){contentSet.push(t.Value),labels.push(t.Key)}),datasets.push({label:"New Content",data:contentSet,borderColor:contentColour,backgroundColor:contentColour,pointBackgroundColor:contentColour,pointBorderColor:"#ffffff"});var o=t.users.days.slice(Math.max(t.content.days.length-Number($("#history").val()),1));contentSet=[],o.forEach(function(t){contentSet.push(t.Value)}),datasets.push({label:"New Users",data:contentSet,borderColor:userColour,backgroundColor:userColour,pointBackgroundColor:userColour,pointBorderColor:"#ffffff"});var a=t.subs.days.slice(Math.max(t.content.days.length-Number($("#history").val()),1));contentSet=[],a.forEach(function(t){contentSet.push(t.Value)}),datasets.push({label:"New Subscriptions",data:contentSet,borderColor:subColour,backgroundColor:subColour,pointBackgroundColor:subColour,pointBorderColor:"#ffffff"});var n=t.properties.days.slice(Math.max(t.content.days.length-Number($("#history").val()),1));contentSet=[],n.forEach(function(t){contentSet.push(t.Value)}),datasets.push({label:"New Properties",data:contentSet,borderColor:propertyColour,backgroundColor:propertyColour,pointBackgroundColor:propertyColour,pointBorderColor:"#ffffff"}),dataLabels=labels}else labels=[],contentSet=[],t.content.months.forEach(function(t){contentSet.push(t.Value),labels.push(t.Key)}),datasets.push({label:"New Content",data:contentSet,borderColor:contentColour,backgroundColor:contentColour,pointBackgroundColor:contentColour,pointBorderColor:"#ffffff"}),contentSet=[],t.users.months.forEach(function(t){contentSet.push(t.Value)}),datasets.push({label:"New Users",data:contentSet,borderColor:contentColour,backgroundColor:contentColour,pointBackgroundColor:contentColour,pointBorderColor:"#ffffff"}),contentSet=[],t.subs.months.forEach(function(t){contentSet.push(t.Value)}),datasets.push({label:"New Subscriptions",data:contentSet,borderColor:subColour,backgroundColor:subColour,pointBackgroundColor:subColour,pointBorderColor:"#ffffff"}),contentSet=[],t.properties.months.forEach(function(t){contentSet.push(t.Value)}),datasets.push({label:"New Properties",data:contentSet,borderColor:propertyColour,backgroundColor:propertyColour,pointBackgroundColor:propertyColour,pointBorderColor:"#ffffff"}),dataLabels=labels;var s=document.getElementById("admin-stats-chart");new Chart(s,{type:"bar",data:{labels:dataLabels,datasets:datasets},responsive:!0,maintainAspectRatio:!1,options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})},LoadStats:function(t){for($(".content-totalPosts").text(t.content.totalPosts),$(".content-totalPublished").text(t.content.totalPublished),$(".users-totalUsers").text(t.users.totalUsers),$(".users-totalAdmins").text(t.users.totalAdmins),$(".subs-active").text(t.subs.active),$(".subs-trials").text(t.subs.trials),$(".properties-totalPosts").text(t.properties.totalPosts),$(".properties-totalPublished").text(t.properties.totalPublished),i=0;i<t.content.byType.length;i++)$(".content-"+t.content.byType[i].typeName+"-total").text(t.content.byType[i].total);$('[data-plugin="counterup"]').counterUp({delay:10,time:2e3})}},CheckAndLoadTabs:function(t){$(t).each(function(){var t=$('<li class="nav-item d-inline d-lg-none"></li>'),e=$('<div class="dropdown-menu"></ul>'),o=$('<ul class="navbar-nav"></ul>');$(this).find("> li").each(function(){link=$(this).children("a:first-child");var t=$('<li class="nav-item"><a href="'+link.attr("href")+'" data-toggle="tab" class="nav-link tab-switch">'+link.html()+"</a></li>");o.append(t),$(this).addClass("d-none d-lg-inline")}),t.append('<a class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-eye mr-2"></i><span>Choose View</span></button>'),e.append(o),t.append(e),$(this).prepend(t)}),$(t+' a[data-toggle="tab"]').on("shown.bs.tab",function(e){localStorage.setItem("tab-"+$(t).data("id"),$(e.target).attr("href"))});var e=localStorage.getItem("tab-"+$(t).data("id"));e?$(t+' a[href="'+e+'"]').tab("show"):$(t+' a[data-toggle="tab"]').first().tab("show")}},$(document).ready($.hood.Admin.Ready),$(window).on("load",$.hood.Admin.Load),$(window).on("resize",$.hood.Admin.Resize),$.hood.Admin.Init();
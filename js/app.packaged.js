"use strict";$.hood||($.hood={}),$.hood.Cart={Init:function(){$("#CheckoutProgress").fadeOut(),$("body").on("click",".cart-add",$.hood.Cart.Add),$("body").on("click",".cart-clear",$.hood.Cart.Clear),$("body").on("click",".cart-update",$.hood.Cart.Update),$("body").on("click",".cart-remove",$.hood.Cart.Remove),$("body").on("change",".delivery-select",function(){$("#DeliveryAddressId").val($(this).val())}),$("body").on("change",".billing-select",function(){$("#BillingAddressId").val($(this).val())})},Add:function(e){$(this).data("temp",$(this).html()),$(this).addClass("btn-loading").append('<i class="fa fa-refresh fa-spin m-l-xs"></i>'),$.post("/cart/add",{productID:$(this).data("id"),qty:1},function(e){$(".btn-loading").each(function(){$(this).removeClass("btn-loading").html($(this).data("temp"))}),e.Success?($.hood.Alerts.Success("Added to your cart!"),$.hood.Cart.ReloadMiniCart()):($.hood.Alerts.Error("Couldn't add to your cart..."),$.hood.Cart.ReloadMiniCart())}),e.preventDefault()},Update:function(e){$.post("/cart/update",{productID:$(this).data("id"),qty:$(this).data("change")},function(e){e.Success?($.hood.Alerts.Success("Your shopping cart has been updated!"),$.hood.Cart.ReloadMiniCart()):$.hood.Alerts.Error("Couldn't update your cart...")}),e.preventDefault()},Remove:function(e){$.post("/cart/remove",{productID:$(this).data("id")},function(e){e.Success?($.hood.Alerts.Success("Your shopping cart has been updated!"),$.hood.Cart.ReloadMiniCart()):$.hood.Alerts.Error("Couldn't update your cart...")}),e.preventDefault()},Clear:function(e){$.post("/cart/clear",{},function(e){e.Success?($.hood.Alerts.Success("Your shopping cart has been cleared!"),$.hood.Cart.ReloadMiniCart()):$.hood.Alerts.Error("Couldn't clear your cart...")}),e.preventDefault()},ReloadMiniCart:function(e){$(".hood-inline-cart").each(function(){$.hood.Inline.Reload(this)})}},$.hood.Cart.Init(),$.hood||($.hood={}),$.hood.Stripe={Init:function(){$("body").on("click",".payment-method-setdefault",$.hood.Stripe.PaymentMethods.SetDefault),$("body").on("click",".payment-method-delete",$.hood.Stripe.PaymentMethods.Delete),$("#card-add-form").doesExist()&&$.hood.Stripe.PaymentMethods.Add(),$("#buy-plan-form").doesExist()&&$.hood.Stripe.Subscriptions.Buy()},Lists:{PaymentMethods:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#payment-method-list").doesExist()&&$.hood.Inline.Reload($("#payment-method-list"),e)}}},PaymentMethods:{Stripe:null,CardElement:null,Add:function(){$.hood.Stripe.PaymentMethods.Stripe=Stripe($("#card-add-form").data("stripe"));var e=$.hood.Stripe.PaymentMethods.Stripe.elements();$.hood.Stripe.PaymentMethods.CardElement=e.create("card"),$.hood.Stripe.PaymentMethods.CardElement.mount("#card-add-element"),$("#card-add-form").validate({rules:{CardholderName:"required"}}),$("body").on("click","#card-add-submit",$.hood.Stripe.PaymentMethods.SubmitCardForm)},SubmitCardForm:function(e){return e.preventDefault(),$("#card-add-consent").is(":checked")?void($("#card-add-form").valid()&&!$("#card-add-submit").hasClass("processing")&&($.hood.Stripe.PaymentMethods.ToggleButton(!0),$.hood.Stripe.PaymentMethods.Stripe.handleCardSetup($("#card-add-submit").data("secret"),$.hood.Stripe.PaymentMethods.CardElement,{payment_method_data:{billing_details:{name:$("#card-add-cardholdername").val()}}}).then(function(e){e.error?($("#card-add-errors").html(e.error.message),$.hood.Stripe.PaymentMethods.ToggleButton(!1)):$.hood.Stripe.PaymentMethods.ConfirmIntent(e)}))):($("#card-add-errors").html("You cannot add a card without agreeing to the customer agreement."),void $.hood.Stripe.PaymentMethods.ToggleButton(!1))},HandleServerResponse:function(e){e.error?($("#card-add-errors").html(e.error.message),$.hood.Stripe.PaymentMethods.ToggleButton(!1)):e.requires_action?$.hood.Stripe.PaymentMethods.Stripe.handleCardAction(e.payment_intent_client_secret).then(function(e){e.error?($("#card-add-errors").html(e.error.message),$.hood.Stripe.PaymentMethods.ToggleButton(!1)):$.hood.Stripe.PaymentMethods.ConfirmIntent(e)}):($("#card-add-errors").html(""),$("#card-add-success").html("Card added successfully, please wait..."),$.hood.Stripe.PaymentMethods.ToggleButton(!1),$.hood.Stripe.Lists.PaymentMethods.Reload(),$.hood.Inline.CloseModal())},ConfirmIntent:function(e){fetch($("#card-add-submit").data("url"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Id:e.setupIntent.id})}).then(function(e){return e.json()}).then($.hood.Stripe.PaymentMethods.HandleServerResponse)},ToggleButton:function(e){e?($("#card-add-submit").addClass("processing"),$("#card-add-submit").html('<i class="fa fa-spin fa-sync-alt"></i>&nbsp;Processing...')):($("#card-add-submit").removeClass("processing"),$("#card-add-submit").html("Add card to wallet"))},SetDefault:function(e){e.preventDefault(),$tag=$(this),setDefaultCardCallback=function(e){e&&$.post($tag.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Stripe.Lists.PaymentMethods.Reload()})},$.hood.Alerts.Confirm("The card will be used for all transactions from this point onwards.","Are you sure?",setDefaultCardCallback,"warning",'<span class="text-info"><i class="fa fa-exclamation-triangle"></i> <strong>You can change this at any time.</strong></span>')},Delete:function(e){e.preventDefault(),$tag=$(this),deleteCardCallback=function(e){e&&$.post($tag.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Stripe.Lists.PaymentMethods.Reload(),e.Success&&$tag&&$tag.data("redirect")&&($.hood.Alerts.Success("<strong>Card deleted, redirecting...</strong><br />Just taking you back to the list."),setTimeout(function(){window.location=$tag.data("redirect")},1500))})},$.hood.Alerts.Confirm("The card will be permanently removed.","Are you sure?",deleteCardCallback,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong></span>')}},Subscriptions:{Stripe:null,CardElement:null,Buy:function(){$("body").on("change",".buy-plan-method",$.hood.Stripe.Subscriptions.ToggleNewCardForm),$.hood.Stripe.Subscriptions.Stripe=Stripe($("#buy-plan-form").data("stripe"));var e=$.hood.Stripe.Subscriptions.Stripe.elements();$.hood.Stripe.Subscriptions.CardElement=e.create("card"),$.hood.Stripe.Subscriptions.CardElement.mount("#buy-plan-element"),$.hood.Stripe.Subscriptions.CardElement.addEventListener("change",function(e){e.error?$("#buy-plan-errors").html(e.error.message):$("#buy-plan-errors").html()}),$("#buy-plan-form").validate({rules:{CardholderName:"required"}}),$("body").on("click","#buy-plan-submit",$.hood.Stripe.Subscriptions.CompletePurchase)},CompletePurchase:function(e){var t=$("input[name='buy-plan-method']:checked").val();return t?$("#buy-plan-consent").is(":checked")?"new-card"===t?$.hood.Stripe.Subscriptions.BuyWithNewCard(e):$.hood.Stripe.Subscriptions.BuyWithExisting(e):($("#buy-plan-errors").html("You cannot purchase a subscription without agreeing to the customer agreement."),void $.hood.Stripe.Subscriptions.ToggleButton(!1)):($("#buy-plan-errors").html("You have to select a payment method to continue with your purchase."),void $.hood.Stripe.Subscriptions.ToggleButton(!1))},ToggleNewCardForm:function(e){var t=$("input[name='buy-plan-method']:checked").val();"new-card"===t?$("#buy-plan-add-card-form").slideDown():$("#buy-plan-add-card-form").slideUp(),$("#buy-plan-errors").html(""),$("#buy-plan-success").html("")},BuyWithExisting:function(e){e.preventDefault(),$("#buy-plan-submit").hasClass("processing")||fetch($("#buy-plan-submit").data("url"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({PlanId:$("#buy-plan-id").val(),PaymentMethodId:$("input[name='buy-plan-method']:checked").val()})}).then(function(e){return e.json()}).then($.hood.Stripe.Subscriptions.HandleServerResponse)},BuyWithNewCard:function(e){e.preventDefault(),$("#buy-plan-form").valid()&&!$("#buy-plan-submit").hasClass("processing")&&($.hood.Stripe.Subscriptions.ToggleButton(!0),$.hood.Stripe.Subscriptions.Stripe.createToken($.hood.Stripe.Subscriptions.CardElement).then(function(e){e.error?($("#buy-plan-errors").html(e.error.message),$.hood.Stripe.Subscriptions.ToggleButton(!1)):fetch($("#buy-plan-submit").data("url"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({PlanId:$("#buy-plan-id").val(),Token:e.token.id})}).then(function(e){return e.json()}).then($.hood.Stripe.Subscriptions.HandleServerResponse)}))},HandleServerResponse:function(e){e.error?($("#buy-plan-errors").html(e.error.message),$.hood.Stripe.Subscriptions.ToggleButton(!1)):e.requires_action?$.hood.Stripe.Subscriptions.Stripe.handleCardPayment(e.payment_intent_client_secret).then(function(e){e.error?($("#buy-plan-errors").html(e.error.message),$.hood.Stripe.Subscriptions.ToggleButton(!1)):$.hood.Stripe.Subscriptions.ConfirmIntent(e)}):($("#buy-plan-errors").html(""),$("#buy-plan-success").html("Subscription created successfully, please wait..."),$.hood.Stripe.Subscriptions.ToggleButton(!1),e.url&&(window.location=e.url))},ConfirmIntent:function(e){fetch($("#buy-plan-submit").data("url"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({PlanId:$("#buy-plan-id").val(),IntentId:e.paymentIntent.id})}).then(function(e){return e.json()}).then($.hood.Stripe.Subscriptions.HandleServerResponse)},ToggleButton:function(e){e?($("#buy-plan-submit").addClass("processing"),$("#buy-plan-submit").html('<i class="fa fa-spin fa-sync-alt"></i>&nbsp;Processing...')):($("#buy-plan-submit").removeClass("processing"),$("#buy-plan-submit").html("Confirm &amp; Pay"))}}},$.hood.Stripe.Init(),$.window=$(window),$.hood||($.hood={}),$.hood.App={Options:{Header:{Target:"#header",Sticky:!0,StickyClass:"sticky-header"},Alerts:!0,Colorbox:!0,ContactForms:!0,Forums:!0,PaymentPages:!0,RichTextEditors:$(".tinymce-public").length},Init:function(e){$.hood.App.Options=$.extend($.hood.App.Options,e||{}),e&&e.Header&&($.hood.App.Options.Header=$.extend($.hood.App.Options.Header,e.Header||{})),$.hood.App.Header.Init(),$.hood.App.Options.PaymentPages&&$.hood.App.PaymentPages.Init(),$.hood.App.Options.FitVids&&$.hood.App.ResizeVideos(),$.hood.App.Options.ContactForms&&$.hood.App.ContactForms.Init(),$.hood.App.Options.Colorbox&&$.hood.App.Colorbox(),$.hood.App.Options.LoadSharers&&$.hood.App.Sharers(),$.hood.App.Options.RichTextEditors&&$.hood.App.RichTextEditors()},Header:{Init:function(){$.hood.App.Options.Header.Sticky&&($.hood.App.Header.StickyMenu(),$.window.on("scroll",function(){$.hood.App.Header.StickyMenu()}))},StickyMenu:function(){var e=0;$header=$($.hood.App.Options.Header.Target),$header.length>0&&(e=$header.offset().top),header=$header.height(),win=$.window.height()+2*header,doc=$(document).height(),$.window.scrollTop()>e&&doc>win?$header.addClass($.hood.App.Options.Header.StickyClass):$.hood.App.Header.RemoveStickyness()},RemoveStickyness:function(){$header.hasClass($.hood.App.Options.Header.StickyClass)&&$header.removeClass($.hood.App.Options.Header.StickyClass)}},ContactForms:{Init:function(){$(".contact-form .thank-you").hide(),$(".contact-form .form-submit").show(),$("body").on("submit",".contact-form",function(e){return e.preventDefault(),$(this).addClass("loading"),$.hood.App.ContactForms.Submit(this),!1})},Submit:function(e){if($form=$(e),$form.valid()){if($form.hasClass("g-recaptcha")){var t=$form.find(".recaptcha").data("recaptchaid");if(""===grecaptcha.getResponse(t))return $.hood.Alerts.Error("Please tell us you are not a robot!","Confirm Humanity!",null,!0),$form.removeClass("loading"),!1}$.post($form.attr("action"),$form.serialize(),function(e){e.Success?($form.attr("data-redirect")&&(window.location=$form.attr("data-redirect")),$form.attr("data-alert-message")&&$.hood.Alerts.Success($form.attr("data-alert-message"),"Success",null,!0),$form.find(".form").hide(),$form.find(".thank-you").show()):("undefined"!=typeof $form.attr("data-alert-error")&&$.hood.Alerts.Success($form.attr("data-alert-error"),"Error",null,!0),$.hood.Alerts.Error("There was an error sending the message: "+e.Errors,"Error",null,!0)),$form.removeClass("loading")})}return!1}},Alerts:function(){$(".alert.auto-dismiss").fadeTo(5e3,500).slideUp(500,function(){$(".alert.auto-dismiss").slideUp(500)})},Colorbox:function(){$(".colorbox").colorbox({rel:"gallery",maxWidth:"95%",maxHeight:"95%"}),$(".colorbox-iframe").colorbox({iframe:!0,maxWidth:"95%",maxHeight:"95%",innerWidth:640,innerHeight:390})},Forums:{Init:function(){var e=$.getUrlVars().highlight;$.isNumeric(e)&&($post=$("#post-"+e),$("html,body").animate({scrollTop:$post.offset().top-$.hood.App.Options.Scroll.Offset},"slow"),$post.addClass("highlight"),"Created"===$.getUrlVars().message&&$post.addClass("created"));var t=$.getUrlVars().reply;$.isNumeric(t)&&($post=$("#forum-post-form"),$("html,body").animate({scrollTop:$post.offset().top-$.hood.App.Options.Scroll.Offset},"slow")),$(".forum").on("click",".edit-post",function(e){$(this).parents(".post").find(".post-view").slideToggle(),$(this).parents(".post").find(".edit-view").slideToggle()})}},ResizeVideos:function(){return $().fitVids?void $("body").fitVids({customSelector:"iframe[src^='http://www.dailymotion.com/embed'], iframe[src*='maps.google.com'], iframe[src*='google.com/maps']",ignore:".no-fv"}):(console.log("resizeVideos: FitVids not Defined."),!0)},PaymentPages:{Init:function(){$("body").on("click",".btn.price-select[data-target][data-value]",$.hood.App.PaymentPages.PriceSelect),$("body").on("click",".change-price-option",$.hood.App.PaymentPages.ChangePrice)},ChangePrice:function(){$("#price-panel").collapse("show"),$("#billing-panel").collapse("hide"),$("#confirm-panel").collapse("hide")},PriceSelect:function(){var e=$(this);targetId="#"+e.data("target"),$(targetId).val(e.data("value")),$(".selected-price-text").html($(targetId).find(":selected").text()),$('.price-select[data-target="'+e.data("target")+'"]').each(function(){$(this).html($(this).data("temp")).removeClass("active")}),$('.price-select[data-target="'+e.data("target")+'"][data-value="'+e.data("value")+'"]').each(function(){$(this).data("temp",$(this).html()).html("Selected").addClass("active")}),$("#price-panel").collapse("hide"),$("#billing-panel").collapse("show"),$("#confirm-panel").collapse("hide")}},RichTextEditors:function(){tinymce.init({selector:".tinymce-public",height:250,plugins:["advlist autolink lists link image charmap print preview anchor media","searchreplace visualblocks code fullscreen","insertdatetime media contextmenu paste emoticons"],menubar:!1,toolbar:"styleselect | bold italic | bullist numlist outdent indent | undo redo | link image media emoticons",image_dimensions:!1,body_class:"tiny-mce-body",content_css:"/css/site.css"})}},$.hood.App.Init(),$(window).on("load",$.hood.App.Load),$(window).on("resize",$.hood.App.Resize);
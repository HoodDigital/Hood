"use strict";$.hood||($.hood={}),$.hood.Property={Init:function(){$("body").on("click",".property-delete",$.hood.Property.Delete),$("body").on("click",".property-delete-all",$.hood.Property.DeleteAll),$("body").on("click",".property-delete-floor",$.hood.Property.DeleteFloorArea),$("body").on("click",".property-set-status",$.hood.Property.SetStatus),$("body").on("click",".property-media-delete",$.hood.Property.Media.Delete),$("#property-edit-form").doesExist()&&$.hood.Property.Edit.Init()},Lists:{Property:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#property-list").doesExist()&&$.hood.Inline.Reload($("#property-list"),e)}},Media:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#property-gallery-list").doesExist()&&$.hood.Inline.Reload($("#property-gallery-list"),e)}},Floorplans:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#property-floorplans-list").doesExist()&&$.hood.Inline.Reload($("#property-floorplans-list"),e)}},Floorareas:{Loaded:function(e){$.hood.Loader(!1)},Reload:function(e){$("#property-floors-list").doesExist()&&$.hood.Inline.Reload($("#property-floors-list"),e)}}},Delete:function(e){e.preventDefault();var o=$(this),r=function(e){e&&$.post(o.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Property.Lists.Property.Reload(),e.Success&&o&&o.data("redirect")&&($.hood.Alerts.Success("<strong>Property deleted, redirecting...</strong><br />Just taking you back to the property list."),setTimeout(function(){window.location=o.data("redirect")},1500))})};$.hood.Alerts.Confirm("The property will be permanently removed.","Are you sure?",r,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong></span>')},DeleteAll:function(e){e.preventDefault();var o=$(this);Swal.fire({title:"Are you sure?",html:"ALL of the properties will be permanently removed. Type 'DELETE' to continue.",input:"text",inputAttributes:{autocapitalize:"off"},footer:'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This can take a few minutes to complete and CANNOT be undone.</strong></span>',showCancelButton:!0,confirmButtonText:"Delete",showLoaderOnConfirm:!0,preConfirm:function(e){if("delete"!==e.toLowerCase())return Swal.showValidationMessage("You did not type DELETE."),!1;o.attr("href");$.post(o.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Property.Lists.Property.Reload(),e.Success&&o&&o.data("redirect")&&($.hood.Alerts.Success("<strong>Properties deleted, redirecting...</strong><br />Just taking you back to the property list."),setTimeout(function(){window.location=o.data("redirect")},1500)),swal.close()}).fail($.hood.Inline.HandleError).always($.hood.Inline.Finish)},allowOutsideClick:function(){return!Swal.isLoading()}})},SetStatus:function(e){e.preventDefault();var o=$(this),r=function(e){e&&$.post(o.attr("href"),o.data("status"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Property.Lists.Property.Reload()})};$.hood.Alerts.Confirm("The item will be immediately visible on the website.","Are you sure?",r,"warning")},Create:function(){$("#property-create-form").find(".datepicker").datetimepicker({locale:"en-gb",format:"L"}),$("#property-create-form").hoodValidator({validationRules:{Title:{required:!0},Address1:{required:!0},City:{required:!0},County:{required:!0},Country:{required:!0},Postcode:{required:!0},PublishDate:{required:!0,ukdate:!0}},submitButtonTag:$("#property-create-submit"),submitUrl:$("#property-create-form").attr("action"),submitFunction:function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Property.Lists.Property.Reload()}}),$.hood.Google.Addresses.InitAutocomplete()},CreateFloorArea:function(){$("#property-floorArea-create-form").hoodValidator({validationRules:{Name:{required:!0},Number:{required:!0},SquareFeet:{required:!0},SquareMetres:{required:!0}},submitButtonTag:$("#property-floorArea-create-submit"),submitUrl:$("#property-floorArea-create-form").attr("action"),submitFunction:function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Property.Lists.Floorareas.Reload()}}),$("body").on("change",".recalc-floor",$.hood.Property.RecalcFloor)},RecalcFloor:function(e){"SquareMetres"===this.id?$("#property-floorArea-create-form #SquareFeet").val(10.7639*Number($(this).val())):$("#property-floorArea-create-form #SquareMetres").val(Number($(this).val())/10.7639)},DeleteFloorArea:function(e){e.preventDefault();var o=$(this),r=function(e){e&&$.post(o.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Property.Lists.Floorareas.Reload()})};$.hood.Alerts.Confirm("The floor will be permanently removed.","Are you sure?",r,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong></span>')},Edit:{Init:function(){$(".datepicker").datetimepicker({locale:"en-gb",format:"L"}),$.hood.Property.Upload.InitImageUploader(),$.hood.Property.Upload.InitFloorplanUploader()}},Upload:{InitImageUploader:function(){if($("#property-gallery-add").doesExist()){$("#property-gallery-total-progress").hide(),Dropzone.autoDiscover=!1;var e=new Dropzone("#property-gallery-upload",{url:$("#property-gallery-upload").data("url"),thumbnailWidth:80,thumbnailHeight:80,parallelUploads:5,previewTemplate:!1,paramName:"files",autoProcessQueue:!0,previewsContainer:!1,clickable:"#property-gallery-add",dictDefaultMessage:'<span><i class="fa fa-cloud-upload fa-4x"></i><br />Drag and drop files here, or simply click me!</div>',dictResponseError:"Error while uploading file!"});e.on("success",function(e,o){$.hood.Helpers.ProcessResponse(o),$.hood.Property.Lists.Media.Reload()}),e.on("addedfile",function(e){$("#property-gallery-total-progress .progress-bar").css({width:"0%"}),$("#property-gallery-total-progress .progress-bar .percentage").html("0%")}),e.on("totaluploadprogress",function(e){$("#property-gallery-total-progress .progress-bar").css({width:e+"%"}),$("#property-gallery-total-progress .progress-bar .percentage").html(e+"%")}),e.on("sending",function(e){$("#property-gallery-total-progress").fadeIn(),$("#property-gallery-total-progress .progress-bar").css({width:"0%"}),$("#property-gallery-total-progress .progress-bar .percentage").html("0%")}),e.on("complete",function(e){$.hood.Property.Lists.Media.Reload()}),e.on("queuecomplete",function(e){$("#property-gallery-total-progress").hide(),$.hood.Property.Lists.Media.Reload()})}},InitFloorplanUploader:function(){if($("#property-floorplans-add").doesExist()){$("#property-floorplans-total-progress").hide(),Dropzone.autoDiscover=!1;var e=new Dropzone("#property-floorplans-upload",{url:$("#property-floorplans-upload").data("url"),thumbnailWidth:80,thumbnailHeight:80,parallelUploads:5,previewTemplate:!1,paramName:"files",autoProcessQueue:!0,previewsContainer:!1,clickable:"#property-floorplans-add",dictDefaultMessage:'<span><i class="fa fa-cloud-upload fa-4x"></i><br />Drag and drop files here, or simply click me!</div>',dictResponseError:"Error while uploading file!"});e.on("success",function(e,o){$.hood.Helpers.ProcessResponse(o),$.hood.Property.Lists.Floorplans.Reload()}),e.on("addedfile",function(e){$("#property-floorplans-total-progress .progress-bar").css({width:"0%"}),$("#property-floorplans-total-progress .progress-bar .percentage").html("0%")}),e.on("totaluploadprogress",function(e){$("#property-floorplans-total-progress .progress-bar").css({width:e+"%"}),$("#property-floorplans-total-progress .progress-bar .percentage").html(e+"%")}),e.on("sending",function(e){$("#property-floorplans-total-progress").fadeIn(),$("#property-floorplans-total-progress .progress-bar").css({width:"0%"}),$("#property-floorplans-total-progress .progress-bar .percentage").html("0%")}),e.on("complete",function(e){$.hood.Property.Lists.Floorplans.Reload()}),e.on("queuecomplete",function(e){$("#property-floorplans-total-progress").hide(),$.hood.Property.Lists.Floorplans.Reload()})}}},Media:{Delete:function(e){e.preventDefault();var o=$(this),r=function(e){e&&$.post(o.attr("href"),function(e){$.hood.Helpers.ProcessResponse(e),$.hood.Property.Lists.Media.Reload(),$.hood.Property.Lists.Floorplans.Reload()})};$.hood.Alerts.Confirm("The image/media will be permanently removed.","Are you sure?",r,"error",'<span class="text-danger"><i class="fa fa-exclamation-triangle"></i> <strong>This process CANNOT be undone!</strong><br /><span class="text-warning">If this is set as a featured image, this may cause issues, make sure to set another image as featured before deleting this one.</span></span>')}}},$(document).ready($.hood.Property.Init);
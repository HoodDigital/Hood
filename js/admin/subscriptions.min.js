"use strict";$.hood||($.hood={}),$.hood.Subscriptions={Init:function(){$("body").on("click",".delete-subscription",this.Delete),$("body").on("click",".create-subscription",this.Create.Init),$("#edit-subscription").doesExist()&&this.Edit.Init()},Delete:function(e){var t=$(this);swal({title:"Are you sure?",text:"The subscription will be permanently removed.",type:"warning",confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, cancel!",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,closeOnCancel:!1},function(e){e?$.post("/admin/subscriptions/delete",{id:t.data("id")},function(e){e.Success?($("#manage-subscription-list").doesExist()||(window.location="/admin/subscriptions/"),$.hood.Subscriptions.Manage.Refresh(),$.hood.Blades.Close(),swal({title:"Deleted!",text:"The subscription has now been removed from the website.",timer:1300,type:"success"})):swal({title:"Error!",text:"There was a problem deleting the subscription: "+e.Errors,timer:1300,type:"error"})}):swal("Cancelled","It's all good in the hood!","error")})},Create:{Init:function(e){e.preventDefault(),$.hood.Blades.OpenWithLoader("button.create-subscription","/admin/subscriptions/create/",$.hood.Subscriptions.Create.SetupCreateForm)},SetupCreateForm:function(){$("#create-subscription-form").find(".datepicker").datetimepicker({locale:"en-gb",format:"L"}),$("#create-subscription-form").hoodValidator({validationRules:{Title:{required:!0},Description:{required:!0},Amount:{required:!0},Currency:{required:!0},Interval:{required:!0},IntervalCount:{required:!0},Name:{required:!0}},submitButtonTag:$("#create-subscription-submit"),submitUrl:"/admin/subscriptions/add",submitFunction:function(e){e.Success?(swal("Created!","The subscription has now been created!","success"),e.Url&&(window.location=e.Url)):swal("Error","There was a problem creating the subscription:\n\n"+e.Errors,"error")}})}},Edit:{Init:function(){this.LoadEditors("#edit-subscription"),$.hood.Editor.Init(".edit-subscription-editor")},Blade:function(){this.LoadEditors("#subscription-blade"),$("#subscription-blade select").each($.hood.Handlers.SelectSetup),$("#subscription-blade-form").hoodValidator({validationRules:{Title:{required:!0},Excerpt:{required:!0}},submitButtonTag:$("#save-blade"),submitUrl:"/admin/subscriptions/save/"+$("#subscription-blade-form").data("id"),submitFunction:function(e){e.Succeeded?($("#manage-subscription-list").data("hoodDataList").Refresh(),$.hood.Alerts.Success("Updated.")):$.hood.Alerts.Error("There was an error saving.")}})},LoadEditors:function(e){$(e).find(".datepicker").datetimepicker({locale:"en-gb",format:"L"})}}},$.hood.Subscriptions.Init();